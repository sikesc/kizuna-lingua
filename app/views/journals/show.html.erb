<div style="height: calc(100vh - 56px); height: calc(100dvh - 56px); display: flex; flex-direction: column; background: #F8FAFC;">
  <!-- Header Section -->
  <header style="background: linear-gradient(135deg, #1E293B 0%, #475569 100%); padding: 1.5rem 1rem; flex-shrink: 0;">
    <div style="display: flex; align-items: flex-start; gap: 1rem; max-width: 1000px; margin: 0 auto;">
      <%= link_to partnership_journals_path(@journal.partnership), style: "display: flex; align-items: center; justify-content: center; width: 2.5rem; height: 2.5rem; background: rgba(255,255,255,0.1); border-radius: 0.5rem; color: white; text-decoration: none; flex-shrink: 0;" do %>
        <i class="fas fa-arrow-left" style="font-size: 1rem;"></i>
      <% end %>
      <div style="flex: 1; min-width: 0;">
        <h1 style="font-size: 1.5rem; font-weight: 700; color: white; margin: 0 0 0.25rem 0; line-height: 1.2;"><%= @journal.challenge.topic.name %></h1>
        <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7); margin: 0;"><%= @journal.created_at.strftime("%B %d, %Y") %></p>
      </div>
    </div>
  </header>

  <!-- Content Container -->
  <main style="flex: 1; overflow-y: auto; padding: 1.5rem 1rem;">
    <div style="max-width: 1000px; margin: 0 auto; display: flex; flex-direction: column; gap: 1.5rem;">

      <!-- Journal Entry Card (right aligned) -->
      <div style="display: flex; justify-content: flex-end; padding-left: 2rem;">
        <div style="background: white; border-radius: 1rem; box-shadow: 0 4px 16px rgba(30,41,59,0.08); overflow: hidden;">
          <!-- Card Header -->
          <div style="background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%); padding: 1rem 1.25rem; display: flex; align-items: center; gap: 0.75rem;">
            <% if @journal.user.photo.attached? %>
              <%= image_tag url_for(@journal.user.photo), style: "width: 2.5rem; height: 2.5rem; border-radius: 50%; object-fit: cover; border: 2px solid rgba(255,255,255,0.3);" %>
            <% else %>
              <div style="width: 2.5rem; height: 2.5rem; border-radius: 50%; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 1rem; font-weight: 600; color: white;">
                <%= @journal.user.name.first.upcase %>
              </div>
            <% end %>
            <div style="flex: 1;">
              <div style="font-size: 0.9375rem; font-weight: 600; color: white;"><%= @journal.user.name %></div>
              <div style="font-size: 0.75rem; color: rgba(255,255,255,0.8);"><%= @journal.created_at.strftime("%l:%M %p") %></div>
            </div>
            <div style="display: flex; align-items: center; gap: 0.375rem; background: rgba(255,255,255,0.2); padding: 0.375rem 0.75rem; border-radius: 1rem;">
              <i class="fas fa-pen" style="font-size: 0.625rem; color: white;"></i>
              <span style="font-size: 0.6875rem; font-weight: 600; color: white; text-transform: uppercase; letter-spacing: 0.025em;">Journal Entry</span>
            </div>
          </div>
          <!-- Card Content -->
          <div style="padding: 1.25rem; font-size: 1rem; line-height: 1.7; color: #334155;">
            <%= simple_format(@journal.content, {}, wrapper_tag: "div") %>
          </div>
        </div>
      </div>

      <!-- Feedback Card (left aligned) -->
      <% if @journal.feedback.present? %>
        <% partner = @journal.partnership.partner_of(@journal.user) %>
        <div style="display: flex; justify-content: flex-start; padding-right: 2rem;">
          <div style="background: white; border-radius: 1rem; box-shadow: 0 4px 16px rgba(30,41,59,0.08); overflow: hidden;">
            <!-- Card Header -->
            <div style="background: linear-gradient(135deg, #20B2AA 0%, #3CCDC5 100%); padding: 1rem 1.25rem; display: flex; align-items: center; gap: 0.75rem;">
              <% if partner&.photo&.attached? %>
                <%= image_tag url_for(partner.photo), style: "width: 2.5rem; height: 2.5rem; border-radius: 50%; object-fit: cover; border: 2px solid rgba(255,255,255,0.3);" %>
              <% else %>
                <div style="width: 2.5rem; height: 2.5rem; border-radius: 50%; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 1rem; font-weight: 600; color: white;">
                  <%= partner&.name&.first&.upcase || "P" %>
                </div>
              <% end %>
              <div style="flex: 1;">
                <div style="font-size: 0.9375rem; font-weight: 600; color: white;"><%= partner&.name || "Partner" %></div>
                <div style="font-size: 0.75rem; color: rgba(255,255,255,0.8);"><%= @journal.updated_at.strftime("%l:%M %p") %></div>
              </div>
              <div style="display: flex; align-items: center; gap: 0.375rem; background: rgba(255,255,255,0.2); padding: 0.375rem 0.75rem; border-radius: 1rem;">
                <i class="fas fa-comment-dots" style="font-size: 0.625rem; color: white;"></i>
                <span style="font-size: 0.6875rem; font-weight: 600; color: white; text-transform: uppercase; letter-spacing: 0.025em;">Feedback</span>
              </div>
            </div>
            <!-- Card Content -->
            <div style="padding: 1.25rem; font-size: 1rem; line-height: 1.7; color: #334155;">
              <%= simple_format(@journal.feedback, {}, wrapper_tag: "div") %>
            </div>
          </div>
        </div>
      <% else %>
        <!-- Empty state for no feedback -->
        <div style="display: flex; justify-content: flex-start; padding-right: 2rem;">
          <div style="background: white; border-radius: 1rem; box-shadow: 0 4px 16px rgba(30,41,59,0.08); padding: 2rem; text-align: center;">
            <div style="width: 4rem; height: 4rem; border-radius: 50%; background: linear-gradient(135deg, #E2E8F0 0%, #CBD5E1 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
              <i class="fas fa-comments" style="font-size: 1.5rem; color: #94A3B8;"></i>
            </div>
            <p style="font-size: 1rem; color: #64748B; margin: 0 0 0.25rem;">Waiting for feedback</p>
            <p style="font-size: 0.875rem; color: #94A3B8; margin: 0;">Your partner hasn't responded yet</p>
          </div>
        </div>
      <% end %>
    </div>
  </main>

  <!-- Feedback Input (only shown if user can provide feedback) -->
  <% if policy(@journal).update? %>
    <footer style="flex-shrink: 0; background: white; padding: 1rem 1.5rem; border-top: 1px solid #E2E8F0; box-shadow: 0 -4px 16px rgba(30,41,59,0.05);">
      <%= simple_form_for @journal, html: { style: "max-width: 1000px; margin: 0 auto;" } do |f| %>
        <div style="display: flex; flex-direction: column; gap: 0.75rem; background: #F8FAFC; border-radius: 1rem; padding: 1rem; border: 1px solid #E2E8F0;">
          <%= f.input :feedback, as: :text, label: false, input_html: {
            style: "width: 100%; border: none; background: transparent; font-size: 1rem; color: #334155; resize: none; min-height: 80px; line-height: 1.6; outline: none;",
            placeholder: "Write your feedback...",
            rows: 3
          }, wrapper: false %>
          <div style="display: flex; justify-content: flex-end;">
            <button type="submit" style="display: flex; align-items: center; justify-content: center; padding: 0.75rem 1.5rem; background: linear-gradient(135deg, #20B2AA 0%, #3CCDC5 100%); border: none; border-radius: 0.75rem; color: white; cursor: pointer; flex-shrink: 0; font-size: 0.875rem; font-weight: 600; gap: 0.5rem;">
              <span>Send Feedback</span>
              <i class="fas fa-paper-plane" style="font-size: 0.75rem;"></i>
            </button>
          </div>
        </div>
      <% end %>
    </footer>
  <% end %>
</div>
