<!DOCTYPE html>
<html>
  <head>
    <title><%= meta_title %></title>
    <meta name="description" content="<%= meta_description %>">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%# Open Graph meta tags %>
    <meta property="og:title" content="<%= meta_title %>">
    <meta property="og:description" content="<%= meta_description %>">
    <meta property="og:image" content="<%= meta_image %>">
    <meta property="og:type" content="website">
    <%# Twitter Card meta tags %>
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="<%= meta_title %>">
    <meta name="twitter:description" content="<%= meta_description %>">
    <meta name="twitter:image" content="<%= meta_image %>">
    <link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <%= javascript_importmap_tags %>
    <%= render 'shared/ios_pwa_links' %>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Delius&family=Faustina:ital,wght@0,300..800;1,300..800&family=Funnel+Sans:ital,wght@0,300..800;1,300..800&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Zen+Old+Mincho&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Alan+Sans:wght@300..900&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+JP&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Story+Script&display=swap');
    </style>
  </head>
  <body data-controller="notification-panel">
    <% if current_user %>
      <%# Overlay for closing panel by clicking outside %>
      <div data-notification-panel-target="overlay"
           data-action="click->notification-panel#toggle"
           class="notification-overlay"></div>
      <%# Notification Panel (controlled by Stimulus) %>
      <div data-notification-panel-target="panel" class="notification-panel-container">
        <div class="notification-panel-header">
          <h3>Notifications</h3>
          <a href="#" data-action="click->notification-panel#toggle" class="close-panel-btn">&times;</a>
        </div>
        <div class="notification-panel-body" data-notification-panel-target="notifications" id="notifications-list">
          <% @notifications.each do |notification| %>
            <%= render partial: "notifications/notification", locals: { notification: notification } %>
          <% end %>
        </div>
      </div>
    <% end %>

    <%= render "shared/flashes" %>
    <%= yield %>
    <% if current_user %>
      <%= render "shared/footer" %>
    <% end %>
  </body>
</html>
